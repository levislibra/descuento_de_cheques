<?xml version="1.0"?>
<openerp>
    <data>

    <record id="inherit_account_move_line_tree" model="ir.ui.view">
        <field name="name">inherits.account.move.line.tree</field>
        <field name="model">account.move.line</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree string="Movimientos">
                <field name="date"/>
                <field name="subcuenta_id"/>
                <field name="name"/>
                <field name="debit" sum="Total Debito"/>
                <field name="credit" sum="Total Credito"/>
                <field name="monto_interes" sum="Total Intereses"/>
                <field name="saldo"/>
                <field name="dias"/>
                <field name="tasa_descubierto"/>
                <field name="interes_generado"/>
                <field name="interes_fijo"/>
            </tree>
        </field>
    </record>

    <act_window
    id="opciones_subcuenta_action"
    name="Opciones con movimientos"
    res_model="form.opciones.subcuenta.move.line"
    src_model="account.move.line"
    view_mode="form"
    multi="False"
    target="new"
    key2="client_action_multi"/>

    <!-- Form - form.opciones.subcuenta.move.line  -->

    <record id="form_opciones_subcuenta_move_line_form" model="ir.ui.view">
        <field name="name">form.opciones.subcuenta.move.line</field>
        <field name="model">form.opciones.subcuenta.move.line</field>
        <field name="arch" type="xml">
            <form string="Opciones">
                <header>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <group>
                        <field name="cambiar_tasa"/>
                        <field name="tasa_de_interes" attrs="{'invisible': [('cambiar_tasa', '=', False)]}"/>

                        <field name="fijar_monto_de_interes"/>
                        <field name="monto_interes" attrs="{'invisible': [('fijar_monto_de_interes', '=', False)]}"/>

                        <field name="crear_movimiento"/>
                        <field name="fecha_movimiento" attrs="{'invisible': [('crear_movimiento', '=', False)]}"/>

                        <field name="asentar_interes"/>
                        <field name="journal_intereses_id" attrs="{'invisible': [('asentar_interes', '=', False)]}"/>

                        <field name="cambiar_subcuenta"/>
                        <field name="cuenta_entidad_id" invisible="1" />
                        <field name="subcuenta_destino_id" domain="[('cuenta_entidad_id.id', '=', cuenta_entidad_id)]" attrs="{'invisible': [('cambiar_subcuenta', '=', False)]}"/>

                    </group>
                </sheet>
                <footer>
                        <button string='Validate' states="borrador" name="validar" type="object" class="btn-primary"/>
                        <button string="Cancel" states="borrador" class="btn-default" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Crear Subcuenta  -->
    <record id="subcuenta_form" model="ir.ui.view">
        <field name="name">Subcuenta</field>
        <field name="model">subcuenta</field>
        <field name="arch" type="xml">
            <form string="Subcuenta" editable="bottom">
                <header>
                    <button name="activar" states="borrador" string="Activar" type="object"/>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <group>
                        <field name="name" attrs="{'readonly': [('state', '!=', 'borrador')]}"/>
                        <field name="tipo" attrs="{'readonly': [('state', '!=', 'borrador')]}"/>
                        <field name="cuenta_entidad_id" attrs="{'required': [('state', '=', 'borrador')], 'readonly': [('state', '!=', 'borrador')]}"/>
                        <!--<field name="journal_id" attrs="{'readonly': [('state', '!=', 'borrador')]}"/>
                        <field name="account_id" domain="['|', ('internal_type','=', 'receivable'), ('internal_type','=', 'payable'), ('deprecated', '=', False)]" attrs="{'readonly': [('state', '!=', 'borrador')]}"/> -->
                        <field name="descuento_de_cheques"/>
                        <field name="tasa_mensual_pagada" attrs="{'invisible': [('tipo', '=', 'activo')]}"/>
                        <field name="tasa_fija_descuento" attrs="{'invisible': [('tipo', '=', 'pasivo')]}"/>
                        <field name="tasa_mensual_descuento" attrs="{'invisible': [('tipo', '=', 'pasivo')]}"/>
                        <field name="tasa_descubierto" attrs="{'invisible': [('tipo', '=', 'pasivo')]}"/>
                    </group>
                    <notebook>
                        <page name="Movimientos" string="Movimientos">
                            <button name="button_actualizar_saldo_acumulado" string="Actualizar Cuenta" type="object" />
                            <field name="apuntes_ids" readonly="1">
                                <tree name="movimientos">
                                    <field name="date"/>
                                    <field name="name"/>
                                    <field name="debit" sum="Total"/>
                                    <field name="credit" sum="Total"/>
                                    <field name="sub_saldo"/>
                                    <field name="move_id"/>
                                    <field name="journal_id"/>
                                    <field name="interes_generado"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Tree Subcuenta  -->
    <record id="subcuenta_tree" model="ir.ui.view">
        <field name="name">Subcuenta</field>
        <field name="model">subcuenta</field>
        <field name="arch" type="xml">
            <tree string="Subcuenta" delete="false">
                <field name="cuenta_entidad_id"/>
                <field name="name"/>
                <field name="saldo" sum="Total"/>
                <field name="journal_id"/>
                <field name="descuento_de_cheques"/>
                <field name="tasa_fija_descuento"/>
                <field name="tasa_mensual_descuento"/>
                <field name="tasa_descubierto"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="subcuenta_action" model="ir.actions.act_window">
        <field name="name">Subcuentas</field>
        <field name="res_model">subcuenta</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="subcuenta_tree"/>
    </record>

    <menuitem id="smenu_generales_subcuentas" name="Subcuentas" parent="smenu_generales" action="subcuenta_action" sequence="1" />



    </data>
</openerp>
