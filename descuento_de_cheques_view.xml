<?xml version="1.0"?>
<openerp>
    <data>


    <!-- Cheques - Formularios de lista  -->

    <record id="cheques_financiera_tree" model="ir.ui.view">
        <field name="name">cheques.financiera.tree</field>
        <field name="model">cheques.de.terceros</field>
        <field name="arch" type="xml">
            <tree string="Cheques">
                <field name="entidad_id"/>
                <field name="subcuenta_id"/>
                <field name="liquidacion_id"/>
                <field name="firmante_id"/>
                <field name="banco_id"/>
                <field name="name"/>
                <field name="importe" sum="Total"/>
                <field name="fecha_vencimiento"/>
                <field name="state"/>
                <!--<field name="fecha_deposito"/>
                <field name="account_destino_id" width="50" maxlength="5"/>
                <field name="boleta_deposito" width="20" maxlength="10"/>
                <field name="fecha_acreditacion_contable"/>
                <field name="cuenta_entidad_destino_id"/>
                <field name="subcuenta_destino_id"/>
                <field name="form_rechazo_cheque_id"/>
                -->
            </tree>
        </field>
    </record>

    <record id="cheques_financiera_form" model="ir.ui.view">
        <field name="name">cheques.financiera.form</field>
        <field name="model">cheques.de.terceros</field>
        <field name="arch" type="xml">
            <form string="Cheques">
                <header>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="entidad_id"/>
                            <field name="subcuenta_id"/>
                            <field name="liquidacion_id"/>
                            <field name="firmante_id"/>
                            <field name="banco_id"/>
                            <field name="name"/>
                            <field name="importe"/>
                            <field name="fecha_vencimiento"/>
                        </group>
                        <group>
                            <field name="fecha_deposito"/>
                            <field name="account_destino_id"/>
                            <field name="boleta_deposito"/>
                            <field name="fecha_acreditacion_contable"/>
                            <field name="cuenta_entidad_destino_id"/>
                            <field name="subcuenta_destino_id"/>
                            <field name="form_rechazo_cheque_id"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>


    <record id="cheques_financiera_action" model="ir.actions.act_window">
        <field name="name">Cheques</field>
        <field name="res_model">cheques.de.terceros</field>
        <field name="view_mode">tree,form</field>
        <field name="view_ids"  eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('cheques_financiera_tree')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('cheques_financiera_form')})]"/>
    </record>

    <act_window
    id="form_rechazo_cheque_action"
    name="Rechazar cheque"
    res_model="form.rechazo.cheque"
    src_model="cheques.de.terceros"
    view_mode="form"
    multi="False"
    target="new"
    key2="client_action_multi"/>

    <!-- Liquidacions - Formularios de creacion  -->
    
    <act_window
    id="confirmar_descuento_action"
    name="Confirmar descuento"
    res_model="form.confirmar.descuento"
    src_model="descuento.de.cheques"
    view_mode="form"
    multi="False"
    target="new"
    key2="client_action_multi"/>

    <act_window
    id="pagar_descuento_action"
    name="Pagar descuento"
    res_model="descuento.pago"
    src_model="descuento.de.cheques"
    view_mode="form"
    multi="False"
    target="new"
    key2="client_action_multi"/>

    <record id="descuento_de_cheques_tree" model="ir.ui.view">
        <field name="name">Descuento de cheques Tree</field>
        <field name="model">descuento.de.cheques</field>
        <field name="arch" type="xml">
            <tree string="Lista de liquidaciones">
                <field name="id"/>
                <field name="fecha_liquidacion"/>
                <field name="cuenta_entidad_id"/>
                <field name="bruto_liquidacion" sum="Total"/>
                <field name="gasto_interes_liquidacion" sum="Total"/>
                <field name="neto_liquidacion" sum="Total"/>
                <field name="active"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="descuento_de_cheques_form" model="ir.ui.view">
        <field name="name">Descuento de cheques Form</field>
        <field name="model">descuento.de.cheques</field>
        <field name="arch" type="xml">
            <form string="Formulario de liquidacion" editable="bottom">
                <header>
                    <button type="action"
                            id="confirmar_descuento_pendientes"
                            string="Confirmar"
                            states="cotizacion"
                            name="%(confirmar_descuento_action)d"/>
                    <button type="action"
                            id="pagar_descuento_pendientes"
                            string="Pagar"
                            states="confirmada"
                            name="%(pagar_descuento_action)d"/>
                    <button name="editar" string="Cotizar" states="confirmada,pagado" type="object" />
                    <button name="cancelar" string="Cancelar" states="cotizacion,confirmada" type="object" />
               		<field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <group>
                        <field name="id"/>
                        <field name="fecha_liquidacion" attrs="{'readonly': [('state', '!=', 'cotizacion')]}" context="{'fecha_liquidacion': fecha_liquidacion}"/>
                        <field name="cuenta_entidad_id" attrs="{'readonly': [('state', '!=', 'cotizacion')]}"/>
                        <field name="subcuenta_id" widget='selection' attrs="{'readonly': [('state', '!=', 'cotizacion')]}"/>
                        <field name="journal_id" attrs="{'readonly': [('state', '!=', 'cotizacion')]}"/>
                        <field name="invoice"  attrs="{'readonly': [('state', '!=', 'cotizacion')]}"/>
                    </group>
                    <notebook>
                        <page string="Cheques">
                            <field name="cheques_ids" attrs="{'readonly': [('state', '!=', 'cotizacion')]}">
                                <tree string="Cheques" editable="bottom" >
                                    <field name="state"/>
                                    <field name="name"/>
                                    <field name="firmante_id"/>
                                    <field name="banco_id"/>
                                    <field name="importe" sum="Total"/>
                                    <field name="fecha_vencimiento"/>
                                    <field name="fecha_acreditacion_descuento"/>
                                    <field name="dias_descuento" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                    <field name="tasa_fija_descuento"/>
                                    <field name="monto_fijo_descuento" sum="Total" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                    <field name="tasa_mensual_descuento"/>
                                    <field name="monto_mensual_descuento" sum="Total" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                    <field name="monto_neto_descuento" sum="Total" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                </tree>
                            </field>
                        </page>
                        <page string="subcuentas">
                            <field name="cuenta_subcuentas_ids">
                                <tree string="Subcuentas">
                                    <field name="name"/>
                                    <field name="saldo"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Otros">
                            <group>
                                <field name="invoice_id" attrs="{'invisible': [('invoice', '=', False)]}"/>
                                <group>
                                    <field name="form_confirmar_descuento_id"/>
                                    <field name="move_confirmacion_id"/>
                                </group>
                                <group>
                                    <field name="descuento_pago_id"/>
                                    <field name="move_pago_id"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="liquidaciones_action" model="ir.actions.act_window">
        <field name="name">Liqudiaciones</field>
        <field name="res_model">descuento.de.cheques</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="descuento_de_cheques_tree"/>
    </record>


    <!-- Form confirmacion descuento - Formulario de creacion -->

    <record id="form_confirmar_descuento_tree" model="ir.ui.view">
        <field name="name">form.confirmar.descuento.tree</field>
        <field name="model">form.confirmar.descuento</field>
        <field name="arch" type="xml">
            <tree string="Registros de descuentos">
                <field name="fecha"/>
                <field name="monto"/>
                <field name="journal_id"/>
            </tree>
        </field>
    </record>

    <record id="form_confirmar_descuento_form" model="ir.ui.view">
        <field name="name">form.confirmar.descuento.form</field>
        <field name="model">form.confirmar.descuento</field>
        <field name="arch" type="xml">
            <form string="Pago" editable="bottom">
                <header>
                    <field name="state" widget="statusbar" />
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="journal_id" widget="selection"/>
                            <field name="monto"/>
                        </group>
                        <group>
                            <field name="fecha"/>
                            <field name="move_id"/>
                            <field name="descuento_id" invisible="1"/>
                        </group>
                    </group>
                    <footer>
                        <button string='Validate' states="borrador" name="validar_confirmacion" type="object" class="btn-primary"/>
                        <button string="Cancel" states="borrador" class="btn-default" special="cancel"/>
                    </footer>
                </sheet>
            </form>
        </field>
    </record>

    <!-- pago - Formulario de creacion -->

    <record id="descuento_pago_tree" model="ir.ui.view">
        <field name="name">descuento.pago.tree</field>
        <field name="model">descuento.pago</field>
        <field name="arch" type="xml">
            <tree string="Pagos">
                <field name="fecha"/>
                <field name="monto"/>
                <field name="journal_id"/>
            </tree>
        </field>
    </record>

    <record id="descuento_pago_form" model="ir.ui.view">
        <field name="name">descuento.pago.form</field>
        <field name="model">descuento.pago</field>
        <field name="arch" type="xml">
            <form string="Pago" editable="bottom">
                <header>
                    <field name="state" widget="statusbar" />
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="journal_id" widget="selection"/>
                            <field name="monto"/>
                        </group>
                        <group>
                            <field name="fecha"/>
                            <field name="move_id"/>
                            <field name="descuento_id" invisible="1"/>
                        </group>
                    </group>
                    <footer>
                        <button string='Validate' states="borrador" name="validar_pago" type="object" class="btn-primary"/>
                        <button string="Cancel" states="borrador" class="btn-default" special="cancel"/>
                    </footer>
                </sheet>
            </form>
        </field>
    </record>

        <!-- Form opciones cheques - Formulario -->

    <record id="form_rechazo_cheque_tree" model="ir.ui.view">
        <field name="name">form.rechazo.cheque.tree</field>
        <field name="model">form.rechazo.cheque</field>
        <field name="arch" type="xml">
            <tree string="Cheques">
                <field name="fecha"/>
                <field name="monto"/>
                <field name="journal_id"/>
            </tree>
        </field>
    </record>

    <record id="form_rechazo_cheque_form" model="ir.ui.view">
        <field name="name">form.rechazo.cheque.form</field>
        <field name="model">form.rechazo.cheque</field>
        <field name="arch" type="xml">
            <form string="Cheques">
                <header>
                </header>
                <sheet>
                    <group>
                        <group string="Informacion del origen">
                            <field name="cuenta_entidad_id" widget="selection"/>
                            <field name="subcuenta_id" widget="selection"/>
                            <field name="journal_id"/>
                            <field name="monto"/>
                        </group>
                        <group string="Informacion del destino/deposito">
                            <field name="cuenta_entidad_destino_id"/>
                            <field name="subcuenta_destino_id"/>
                            <field name="account_destino_id"/>
                        </group>
                    </group>
                    <group>
                        <group string="Gastos">
                            <field name="aplicar_gasto"/>
                            <field name="monto_gasto_pagar" attrs="{'invisible': [('aplicar_gasto', '=', False)]}"/>
                            <field name="monto_gasto_cobrar" attrs="{'invisible': [('aplicar_gasto', '=', False)]}"/>
                            <!--<field name="diferencia" attrs="{'invisible': [('aplicar_gasto', '=', False)]}"/>
                            <field name="journal_ganancia_id" attrs="{'invisible': ['|', ('aplicar_gasto', '=', False), ('diferencia', '=', 0)], 'required':[('aplicar_gasto', '!=', False), ('diferencia', '!=', 0)]}"/> -->
                        </group>
                        <group string="Generales">
                            <field name="fecha"/>
                            <field name="detalle"/>
                        </group>
                    </group>
                    <footer>
                        <button string='Validate' name="validar_pago" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </sheet>
            </form>
        </field>
    </record>



    <!-- Menu Principal del modulo (barra superior) - Financiera -->
    <menuitem id="menu_financiera" name="Financiera" />
    
    <!-- SubMenu 1 - Liquidaciones -->
    <menuitem id="smenu_liquidaciones" name="Liquidaciones" parent="menu_financiera"  sequence="1" />
    <menuitem id="smenu_liquidaciones_action" name="Liquidaciones" parent="smenu_liquidaciones" action="liquidaciones_action"  sequence="0" />

    <menuitem id="smenu_liquidaciones_configuracion_action" name="Configuracion" parent="smenu_liquidaciones" action="liquidaciones_action"  sequence="1" />

    <!-- SubMenu 2 - Transferencias -->
    <menuitem id="smenu_generales" name="Generales" parent="menu_financiera"  sequence="2" />

    <menuitem id="smenu_generales_cartera" name="Cartera de cheques" parent="smenu_generales"  sequence="2" action="cheques_financiera_action" />

    <!-- SubMenu 3 - Clientes 
    <menuitem id="smenu_clientes" name="Clientes" parent="menu_financiera"  sequence="3" />
    <menuitem id="smenu_clientes_action" name="Clientes" parent="smenu_clientes" action="base.action_partner_form" sequence="0" />

    <menuitem id="smenu_clientes_configuracion_action" name="Configuracion" parent="smenu_clientes" action="liquidaciones_action"  sequence="3" />
-->
    <!-- SubMenu 4 - Proveedores 
    <menuitem id="smenu_proveedores" name="Proveedores" parent="menu_financiera"  sequence="4" />
    <menuitem id="smenu_proveedores_action" name="Proveedores" parent="smenu_proveedores" action="base.action_partner_supplier_form" sequence="0" />

    <menuitem id="smenu_proveedores_configuracion_action" name="Configuracion" parent="smenu_proveedores" action="liquidaciones_action"  sequence="1" />
-->
    </data>
</openerp>
